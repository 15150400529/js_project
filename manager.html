<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>认识ajax</title>
    <script type="text/javascript" src="jquery.js"></script>
    <style>
        table {
            width: 500px;
            height: 100px;
        }

        th {
            width: 60px;
            height: 30px;
            border: 1px solid blue;
        }

    </style>
</head>

<body>
    <div id="header">
        书名：
        <input type="text" id="name" /> 
        作者:
        <input type="text" id="au" /> 
        数量：
        <input type="text" id="num" />
         出版社:
        <input type="text" id="pub" /> 
        单价：
        <input type="text" id="money" />
        <input type="button" id="addBook" class="add" value="添加图书" />
    </div>
    <table border="1" cellspacing="0" cellpadding="0" id="tab">
        <tr id="clone">
            <th>书名</th>
            <th>作者</th>
            <th>数量</th>
            <th>出版社</th>
            <th>单价</th>
            <th> </th>
        </tr>
    </table>
    <script>
        /* 
                    $.ajax()
                    */
        /*
        $.ajax({
        url:
        type:请求方式.默认是get
        data:发送给服务器的请求参数
        contentType:发送给服务器的数据格式
        dataType:规定服务器返回的数据格式
        success:请求成功的回调函数
        error:请求失败的回调函数
    
        })
        */
        $.ajax({
            url: "books.json",
            dataType: "json",

            success: function(data, textStatus) {
                console.log("--成功--");
                //data -- 请求成功的相应数据 responseText
                //textStatus -- 字符串 请求状态
                console.log(data);
                console.log(textStatus);
                $.each(data.result.list, function(index, item) {
                    console.log(item.bookname);
                })
                fun(data);
            },
            error: function(jqxhr, textStatus, err) {
                console.log(jqxhr, textStatus, err)
            }

        })

        function fun(data) {
            for (var i = 0; i < data.result.list.length; i++) {
                // console.log(data.result.list[i]);
                var oldTr = document.getElementById("clone");
                var newTr = oldTr.cloneNode(true);
                var tds = newTr.getElementsByTagName("th"); //生成多个th
                var tab = document.getElementById("tab");
                tds[0].innerHTML = data.result.list[i].bookname;
                tds[1].innerHTML = data.result.list[i].author;
                tds[2].innerHTML = data.result.list[i].count;
                tds[3].innerHTML = data.result.list[i].publish;
                tds[4].innerHTML = data.result.list[i].price;
                tds[5].innerHTML = '<button id="deleatUser" class="but">删除</button>'
                tab.appendChild(newTr);

                //innerhtml
            }
        }
        
        
        
        //删除某个书的信息
        
        $(document).ready(function(){
      

        $("#tab").on("click", ".but", de);
        function de() {
            console.log("eeeee");
            $(this).parent().parent().remove();
        }
     
        
        //增加某图书信息
          $("#header").on("click",".add",ad);
            function ad(){
                console.log("aaaa");
                var $newt = $("table tr:first").clone(true);
            
		$newt.children("th:first").html($("#name").val());
		$newt.children("th:eq(1)").html($("#au").val());
		$newt.children("th:eq(2)").html($("#num").val());
        $newt.children("th:eq(3)").html($("#pub").val());
		$newt.children("th:eq(4)").html($("#money").val());
                $newt.children("th:eq(5)").html('<button id="deleteB" class="but">删除</button>');
		$newt.appendTo("table");
		$("input:text").val("");
            }
            
            
        });

    </script>
</body>

</html>
